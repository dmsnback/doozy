{% extends 'base.html' %}
{% load static %}
{% load django_bootstrap5 %}

{% block title %}
<title>–ì–ª–∞–≤–Ω–∞—è | doozy</title>
{% endblock %}

{% block content %}
{% if user.is_authenticated %}
<div class="container d-flex justify-content-center mt-5">
  <div class="card shadow-sm" style="width: 28rem;">
    <div class="card-body">
      <h4 class="card-title mb-3 text-center">üìù –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏</h4>
      <!-- —Ñ–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ -->
      <form class="input-group mb-3" method="post" action="{% url 'tasks:create' %}">
        {% csrf_token %}
        <input type="text" name="title" class="form-control" placeholder="–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞" required />
        <button class="btn btn-outline-secondary" type="submit">–î–æ–±–∞–≤–∏—Ç—å</button>
      </form>
      <div>
        <a class="btn btn-outline-secondary" href="{% url 'tasks:create' %}">–î–æ–±–∞–≤–∏—Ç—å c –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏</a>
      </div>
      <br />
      <!-- —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á -->
      <ul class="list-group">
        {% for task in page_obj %}
        {% if task.author == user %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <form method="post" action="{% url 'tasks:toggle_task' task.id %}" class="d-flex align-items-center">
            {% csrf_token %}
            <input class="form-check-input me-2" type="checkbox" onchange="this.form.submit()"  {% if task.completed %}checked{% endif %}>
            <span class="{% if task.completed %}text-decoration-line-through text-muted{% endif %}">{{ task.title }}</span>
          </form>
          <div>
            <a href="{% url 'tasks:edit' task.id %}" class="btn btn-sm btn-outline-gray" data-bs-toggle="tooltip" data-bs-placement="top" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">‚úèÔ∏è</a>
            <form method="post" action="{% url 'tasks:delete' task.id %}" class="d-inline">
              {% csrf_token %}
              <button class="btn btn-sm btn-outline-danger" data-bs-toggle="tooltip" data-bs-placement="top" title="–£–¥–∞–ª–∏—Ç—å">X</button>
            </form>
            <a href="#" class="btn btn-sm btn-outline-gray" data-bs-toggle="tooltip" data-bs-placement="top" title="–ü–æ–¥—Ä–æ–±–Ω–µ–µ">‚û°Ô∏è</a>
          </div>
        </li>
        {% endif %}
        {% endfor %}
      </ul>
    </div>
  </div>
</div>
<div class="container d-flex justify-content-center mt-5">
  {% include 'includes/paginator.html' %}
</div>
{% else %}
<div class="container my-5">
  <div class="p-5 text-center bg-body-tertiary rounded-3">
    <svg class="bi mt-4 mb-3" width="100" height="100">
      <img src="{% static 'img/logo-doozy.png' %}" width="35" height="35" alt="–õ–æ–≥–æ—Ç–∏–ø doozy" />
    </svg>
    <span class="fs-2">doozy</span>
    <h1 class="text-body-emphasis">–í–æ–π–¥–∏—Ç–µ –≤ –ø—Ä–æ—Ñ–∏–ª—å –∏–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å</h1>
    <p class="col-lg-8 mx-auto fs-5 text-muted">
      –£–¥–æ–±–Ω–æ–µ –º–µ—Å—Ç–æ, –≥–¥–µ –º–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å —Å–≤–æ–∏ –∑–∞–¥–∞—á–∏ –∏ –ø–ª–∞–Ω—ã
    </p>
    <div class="d-inline-flex gap-2 mb-5">
      <a class="d-inline-flex align-items-center btn btn-primary btn-lg px-4 rounded-pill" href="{% url 'login' %}" type="button">
        –í–æ–π—Ç–∏
        <svg class="bi ms-2" width="24" height="24"><use xlink:href="#arrow-right-short"></use></svg>
      </a>
      <a class="btn btn-outline-secondary btn-lg px-4 rounded-pill" href="{% url 'registration' %}" type="button">
        –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
      </a>
    </div>
  </div>
</div>
{% endif %}
{% endblock %}
